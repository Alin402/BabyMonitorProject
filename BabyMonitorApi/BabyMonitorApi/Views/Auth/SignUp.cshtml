@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
    
}

<div class="auth-container">
    <h2 style="color: #eb5e92">Sign Up:</h2>
    <div class="form-item">
        <label class="mdc-text-field mdc-text-field--outlined">
            <span class="mdc-notched-outline">
                <span style="border-color: #eb5e92" class="mdc-notched-outline__leading"></span>
                <span style="border-color: #eb5e92" class="mdc-notched-outline__notch">
                    <span style="border-color: #eb5e92; color: #eb5e92" class="mdc-floating-label" id="my-label-id">Name</span>
                </span>
                <span style="border-color: #eb5e92" class="mdc-notched-outline__trailing"></span>
            </span>
            <input id="Name" style="color: #eb5e92; background-color: #272c2b;" type="text" class="mdc-text-field__input">
        </label>
    </div>

    <div class="form-item">
        <label class="mdc-text-field mdc-text-field--outlined">
            <span class="mdc-notched-outline">
                <span style="border-color: #eb5e92" class="mdc-notched-outline__leading"></span>
                <span style="border-color: #eb5e92" class="mdc-notched-outline__notch">
                    <span style="border-color: #eb5e92; color: #eb5e92" class="mdc-floating-label" id="my-label-id">Username</span>
                </span>
                <span style="border-color: #eb5e92" class="mdc-notched-outline__trailing"></span>
            </span>
            <input id="Username" style="color: #eb5e92; background-color: #272c2b;" type="text" class="mdc-text-field__input">
        </label>
    </div>

    <div class="form-item">
        <label class="mdc-text-field mdc-text-field--outlined">
            <span class="mdc-notched-outline">
                <span style="border-color: #eb5e92" class="mdc-notched-outline__leading"></span>
                <span style="border-color: #eb5e92" class="mdc-notched-outline__notch">
                    <span style="border-color: #eb5e92; color: #eb5e92" class="mdc-floating-label" id="my-label-id">Email</span>
                </span>
                <span style="border-color: #eb5e92" class="mdc-notched-outline__trailing"></span>
            </span>
            <input autocomplete="off" id="Email" style="color: #eb5e92; background-color: #272c2b;" type="email" class="mdc-text-field__input">
        </label>
    </div>

    <div class="form-item">
        <label class="mdc-text-field mdc-text-field--outlined">
            <span class="mdc-notched-outline">
                <span style="border-color: #eb5e92" class="mdc-notched-outline__leading"></span>
                <span style="border-color: #eb5e92" class="mdc-notched-outline__notch">
                    <span style="border-color: #eb5e92; color: #eb5e92" class="mdc-floating-label" id="my-label-id">Password</span>
                </span>
                <span style="border-color: #eb5e92" class="mdc-notched-outline__trailing"></span>
            </span>
            <input autocomplete="off" id="Password" style="color: #eb5e92; background-color: #272c2b;" type="password" class="mdc-text-field__input">
        </label>
    </div>

    <div class="form-item">
        <label class="mdc-text-field mdc-text-field--outlined">
            <span class="mdc-notched-outline">
                <span style="border-color: #eb5e92" class="mdc-notched-outline__leading"></span>
                <span style="border-color: #eb5e92" class="mdc-notched-outline__notch">
                    <span style="border-color: #eb5e92; color: #eb5e92" class="mdc-floating-label" id="my-label-id">Confirm Password</span>
                </span>
                <span style="border-color: #eb5e92" class="mdc-notched-outline__trailing"></span>
            </span>
            <input id="ConfirmPassword" style="color: #eb5e92; background-color: #272c2b;" type="password" class="mdc-text-field__input">
        </label>
    </div>

    <div>
        <button id="Submit" class="submit-btn">
            Create &nbsp;<span class="material-symbols-outlined">add_circle</span>
        </button>
    </div>
</div>

<script>
    document.getElementById("Submit").addEventListener("click", async () => {
        const nameElement = document.getElementById("Name");
        const usernameElement = document.getElementById("Username");
        const emailElement = document.getElementById("Email");
        const passwordElement = document.getElementById("Password");
        const confirmPasswordElement = document.getElementById("ConfirmPassword");

        const name = nameElement.value;
        const username = usernameElement.value;
        const email = emailElement.value;
        const password = passwordElement.value;
        const confirmPassword = confirmPasswordElement.value;

        if (password === confirmPassword) {
            try {
                const res = await axios.post("/api/users/create",
                    {
                        Name: name,
                        Username: username,
                        Email: email,
                        Password: password
                    },
                    {
                        headers: {
                            "Content-Type": "application/json",
                        }
                    })
                if (res.status === 200) {
                    window.location.href = "/Auth/SignIn";
                }
            } catch (error)
            {
                Object.entries(error.response.data).forEach(([key, value]) => {
                    value.forEach((validationError) => {
                        showAlert(getAlert(ALERT_ERROR, validationError));
                    })
                });
            }
        } else {
            showAlert(getAlert(ALERT_ERROR, "Passwords do not match"));
        }
    });
</script>
